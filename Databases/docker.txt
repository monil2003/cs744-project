monil@fedora:~/Desktop/Work/DECS$ docker compose version
Docker Compose version v2.40.2
monil@fedora:~/Desktop/Work/DECS$ cd project
bash: cd: project: No such file or directory
monil@fedora:~/Desktop/Work/DECS$ cd Project
monil@fedora:~/Desktop/Work/DECS/Project$ docker compose up -d

monil@fedora:~/Desktop/Work/DECS/Project$ docker exec -it stress_postgres psql -U stressuser -d stressdb         
permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Frun%2Fdocker.sock/v1.51/containers/stress_postgres/json": dial unix /var/run/docker.sock: connect: permission denied
monil@fedora:~/Desktop/Work/DECS/Project$ docker exec -it stress_postgres psql -U stressuser -d stressdb
permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Frun%2Fdocker.sock/v1.51/containers/stress_postgres/json": dial unix /var/run/docker.sock: connect: permission denied
monil@fedora:~/Desktop/Work/DECS/Project$ 
monil@fedora:~/Desktop/Work/DECS/Project$ docker ps
permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Frun%2Fdocker.sock/v1.51/containers/json": dial unix /var/run/docker.sock: connect: permission denied
monil@fedora:~/Desktop/Work/DECS/Project$ groups
monil wheel
monil@fedora:~/Desktop/Work/DECS/Project$ sudo usermod -aG docker $USER
[sudo] password for monil: 
monil@fedora:~/Desktop/Work/DECS/Project$ groups
monil wheel
monil@fedora:~/Desktop/Work/DECS/Project$ sudo usermod -aG docker $USER
monil@fedora:~/Desktop/Work/DECS/Project$ getent group docker
docker:x:968:monil
monil@fedora:~/Desktop/Work/DECS/Project$ newgrp docker
monil@fedora:~/Desktop/Work/DECS/Project$ docker ps
CONTAINER ID   IMAGE         COMMAND                  CREATED          STATUS          PORTS                                         NAMES
81221bbfccfc   postgres:16   "docker-entrypoint.sâ€¦"   10 minutes ago   Up 10 minutes   0.0.0.0:5432->5432/tcp, [::]:5432->5432/tcp   stress_postgres
monil@fedora:~/Desktop/Work/DECS/Project$ groups
docker wheel monil


monil@fedora:~/Desktop/Work/DECS/Project$ docker inspect --format='{{.HostConfig.CpusetCpus}}' stress_postgres
0-3



monil@fedora:~/Desktop/Work/DECS/Project/throttle_io_bottleneck$ sudo ./mount.sh 
Mounted /dev/loop0 on /mnt/loop1
monil@fedora:~/Desktop/Work/DECS/Project/throttle_io_bottleneck$ sudo ./unmount.sh
Unmounting /dev/loop0 from /mnt/loop1...
Detaching /dev/loop0...
Loop device /dev/loop0 detached and unmounted.
monil@fedora:~/Desktop/Work/DECS/Project/throttle_io_bottleneck$ sudo rm -rf /mnt/loop1/pgdata1
monil@fedora:~/Desktop/Work/DECS/Project/throttle_io_bottleneck$ sudo rm -rf /mnt/loop1/pgdata2
monil@fedora:~/Desktop/Work/DECS/Project/throttle_io_bottleneck$ sudo ./mount.sh 
Mounted /dev/loop0 on /mnt/loop1

CREATE PUBLICATION pub_db1 FOR TABLE kv_store;
SELECT * FROM pg_publication;
DROP PUBLICATION pub_name;
setup docker replication


CREATE TABLE IF NOT EXISTS kv_store (
                key_text TEXT PRIMARY KEY,
                value_text TEXT
            );
CREATE SUBSCRIPTION sub_db1
CONNECTION 'host=db1 port=5432 user=stressuser password=stresspass dbname=stressdb'
PUBLICATION pub_db1
WITH (create_slot = true, enabled = true);
CREATE SUBSCRIPTION sub_db2
CONNECTION 'host=db2 port=5432 user=stressuser password=stresspass dbname=stressdb'
PUBLICATION pub_db2
WITH (create_slot = true, enabled = true);


stressdb=# ALTER SUBSCRIPTION sub_db1 DISABLE;
ALTER SUBSCRIPTION
stressdb=# ALTER SUBSCRIPTION sub_db1 SET (slot_name = NONE);
ALTER SUBSCRIPTION
stressdb=# DROP SUBSCRIPTION sub_db1;
DROP SUBSCRIPTION
stressdb=# ALTER SUBSCRIPTION sub_db2 DISABLE;
ALTER SUBSCRIPTION
stressdb=# ALTER SUBSCRIPTION sub_db2 SET (slot_name = NONE);
ALTER SUBSCRIPTION
stressdb=# DROP SUBSCRIPTION sub_db2;
DROP SUBSCRIPTION
stressdb=# select * from pg_subscription;

docker-compose down -v
docker-compose up --build

